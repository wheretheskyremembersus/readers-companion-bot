<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Our Story â€” Readersâ€™ Companion</title>

<style>
/* =========================
   GLOBAL PAGE (Canva-like)
========================= */
body {
  margin: 0;
  font-family: "Palatino Linotype", Palatino, "Book Antiqua", serif;
  background: linear-gradient(
    to bottom,
    #bfc2c4 0%,
    #e4e6e7 35%,
    #ffffff 100%
  );
  color: #222;
}

.page-wrapper {
  max-width: 1200px;
  margin: 0 auto;
  padding: 60px 40px 80px;
}

/* =========================
   TWO-COLUMN LAYOUT
========================= */
.layout {
  display: grid;
  grid-template-columns: 520px 1fr;
  gap: 80px;
  align-items: flex-start;
}

/* =========================
   HEADER
========================= */
.page-header {
  margin-bottom: 32px;
}

.page-header h1 {
  font-size: 22px;
  font-weight: normal;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #555;
  margin: 0 0 10px 0;
}

.page-header p {
  margin: 0;
  font-size: 15px;
  color: #777;
}

/* =========================
   BOT SHELL
========================= */
.bot-shell {
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.18);
  padding: 24px;
}

.chat-body {
  max-height: 420px;
  overflow-y: auto;
  padding: 4px 0;
  font-size: 14px;
  line-height: 1.6;
}
   
/* =========================
   CHAT BUBBLE PREP
========================= */

.message {
  display: flex;
  width: 100%;
  margin-bottom: 12px;
}

.user {
  justify-content: flex-end;
}

.saira-msg {
  justify-content: flex-start;
}

.aayan-msg {
  justify-content: flex-start;
}
.system-msg {
  justify-content: flex-start;
}

.system-msg .bubble {
  background: linear-gradient(135deg, #f4faf5, #e6f4ea);
  border-radius: 18px;
  box-shadow: 0 2px 8px rgba(120, 180, 140, 0.15);
  border: 1px solid rgba(140, 190, 160, 0.2);
}

.bubble {
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 18px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.06);
  word-wrap: break-word;
}

/* User Question (grey) */
.user .bubble {
  background: #e5e5ea;
  border-radius: 18px 18px 4px 18px;
}

/* Saira Reply (light shimmering pink) */
.saira-msg .bubble {
  background: linear-gradient(135deg, #fff1f6, #fde2ec);
  border-radius: 18px 18px 4px 18px;
  box-shadow: 0 2px 8px rgba(255, 160, 190, 0.18);
  border: 1px solid rgba(255, 170, 200, 0.25);
}

/* Aayan Reply (light shimmering blue) */
.aayan-msg .bubble {
  background: linear-gradient(135deg, #eef5ff, #dde9ff);
  border-radius: 18px 18px 18px 4px;
  box-shadow: 0 2px 8px rgba(120, 160, 255, 0.18);
  border: 1px solid rgba(140, 170, 255, 0.25);
}

/* =========================
   QUESTION DOCK
========================= */
.question-dock {
  margin-top: 14px;
  padding-top: 14px;
  border-top: 1px solid #eee;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.btn {
  padding: 6px 14px;
  border-radius: 16px;
  font-size: 13px;
  border: 1px solid #ddd;
  background: #fff;
  cursor: pointer;
}

.btn:disabled {
  opacity: 0.45;
  cursor: default;
}

.saira {
  box-shadow: 0 0 10px rgba(255,180,120,0.55);
}

.aayan {
  box-shadow: 0 0 10px rgba(120,180,255,0.55);
}
   /* Typing Animation */
.typing-bubble {
  display: flex;
  align-items: center;
  gap: 4px;
}

.typing-bubble span {
  width: 6px;
  height: 6px;
  background: #999;
  border-radius: 50%;
  animation: blink 1.4s infinite both;
}

.typing-bubble span:nth-child(2) {
  animation-delay: 0.2s;
}

.typing-bubble span:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes blink {
  0% { opacity: 0.2; }
  20% { opacity: 1; }
  100% { opacity: 0.2; }
}
   
/* =========================
   TYPING AREA
========================= */

.typing-area {
  margin-top: 12px;
  display: flex;
  gap: 8px;
  padding-top: 12px;
  border-top: 1px solid #eee;
}

.typing-area input {
  flex: 1;
  padding: 10px 14px;
  border-radius: 20px;
  border: 1px solid #ddd;
  font-size: 14px;
  outline: none;
  transition: all 0.2s ease;
}

.typing-area input:focus {
  border-color: #bbb;
  box-shadow: 0 0 0 2px rgba(200,200,200,0.15);
}

.typing-area button {
  padding: 8px 16px;
  border-radius: 18px;
  border: none;
  font-size: 13px;
  cursor: pointer;
  background: #222;
  color: white;
  transition: opacity 0.2s ease;
}

.typing-area button:hover {
  opacity: 0.85;
}
#typingIndicator .bubble {
  opacity: 0.8;
  font-style: italic;
}

/* =========================
   PERMISSION PROMPT
========================= */
.reflection-prompt {
  background: #f6f1ea;
  border-left: 3px solid #d8cfc3;
  padding: 14px 16px;
  border-radius: 8px;
}

/* =========================
   TRUST PANEL (RIGHT)
========================= */
.right-column h2 {
  font-size: 22px;
  font-weight: normal;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  margin: 0 0 18px;
}

.right-column h2.spaced {
  margin-top: 48px;
}

.right-column h3 {
  font-size: 13px;
  letter-spacing: 0.12em;
  margin: 0 0 6px;
}

.right-column p {
  font-size: 15px;
  line-height: 1.7;
  margin: 0 0 18px;
}

/* =========================
   FOOTER
========================= */
.page-footer {
  margin-top: 80px;
  font-size: 13px;
  color: #888;
}

/* =========================
   MOBILE
========================= */
@media (max-width: 900px) {
  .layout {
    grid-template-columns: 1fr;
    gap: 60px;
  }
}
</style>
</head>

<body>

<div class="page-wrapper">

  <!-- HEADER -->
  <div class="page-header">
    <h1>Our Story</h1>
    <p>A quiet companion space for <em>Where The Sky Remembers Us</em>.</p>
  </div>

  <div class="layout">

    <!-- LEFT: BOT -->
    <div class="left-column">
    <div class="bot-shell">
  <div class="chat-body" id="chatBody"></div>
  <div class="question-dock" id="questionDock"></div>

  <!-- TYPING AREA -->
  <div class="typing-area" id="typingArea" style="display:none;">
    <input type="text" id="userInput" placeholder="You can ask somethingâ€¦" />
    <button onclick="sendTypedMessage()">Send</button>
  </div>
</div>

    </div>

    <!-- RIGHT: TRUST / CONTACT -->
    <div class="right-column">
      <h2>Reach Out to the Author</h2>

      <h3>WEBSITE</h3>
      <p>www.wheretheskyremembersus.com</p>

      <h2 class="spaced">Privacy Note</h2>
      <p>
        We value your privacy. Information you share through our feedback formâ€”
        such as your name, email, or messageâ€”is used solely to understand and
        respond to your feedback. We do not use cookies, trackers, or third-party tools.
      </p>

      <p>
        For any questions, contact us at:<br>
        <strong>wheretheskyremembersus@gmail.com</strong>
      </p>

      <h2 class="spaced">Communication Address</h2>
      <p>
        PO Box : 10<br>
        General Post Office<br>
        Shillong 793001<br>
        Meghalaya, India
      </p>
    </div>

  </div>

  <div class="page-footer">
  Â© 2026 Mohan R.  
  <br>
  <em>Where The Sky Remembers Us</em>. All rights reserved.
</div>

</div>

<!-- FORM (hidden) -->
<form id="reflectionForm" action="https://formspree.io/f/xaqdqobr" method="POST" style="display:none;">
  <input type="hidden" name="voice" id="formVoice">
  <input type="hidden" name="reflection_1" id="r1">
  <input type="hidden" name="reflection_2" id="r2">
  <input type="hidden" name="reflection_3" id="r3">
  <input type="hidden" name="timestamp" id="formTime">
</form>

<script>
/* =========================
   STATE
========================= */
const chatBody = document.getElementById("chatBody");
const dock = document.getElementById("questionDock");

let activeVoice = null;
let foundationalAnswered = new Set();
let characterAnswered = 0;
let currentLayer = 0;
let reflections = [];
let reflectionStep = 0;
let interactionLocked = false;
let emotionalToggle = false;

/* =========================
   HELPERS
========================= */

/* ---------- Enable Enter Key ---------- */

window.addEventListener("DOMContentLoaded", function () {
  const inputField = document.getElementById("userInput");

  if (inputField) {
    inputField.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        e.preventDefault();
        sendTypedMessage();
      }
    });
  }
});

/* ---------- Auto Scroll ---------- */

function autoScroll() {
  if (!chatBody) return;

  chatBody.scrollTo({
    top: chatBody.scrollHeight,
    behavior: "smooth"
  });
}

/* ---------- Message Builders ---------- */

function addUserMessage(text) {
  chatBody.insertAdjacentHTML(
    "beforeend",
    `<div class="message user">
        <div class="bubble"><strong>${text}</strong></div>
     </div>`
  );
  autoScroll();
}

function addVoiceMessage(text) {
  const side =
    activeVoice === "saira"
      ? "saira-msg"
      : activeVoice === "aayan"
      ? "aayan-msg"
      : "system-msg";

  chatBody.insertAdjacentHTML(
    "beforeend",
    `<div class="message ${side}">
        <div class="bubble">${text}</div>
     </div>`
  );

  autoScroll();
}

function addSystemMessage(text) {
  chatBody.insertAdjacentHTML(
    "beforeend",
    `<div class="message system-msg">
        <div class="bubble">${text}</div>
     </div>`
  );
  autoScroll();
}

/* ---------- Typing Indicator ---------- */

function showTypingIndicator() {
  removeTypingIndicator();

  const side =
    activeVoice === "saira"
      ? "saira-msg"
      : activeVoice === "aayan"
      ? "aayan-msg"
      : "system-msg";

  chatBody.insertAdjacentHTML(
    "beforeend",
    `<div class="message ${side}" id="typingIndicator">
        <div class="bubble typing-bubble">
          <span></span>
          <span></span>
          <span></span>
        </div>
     </div>`
  );

  autoScroll();
}

function removeTypingIndicator() {
  const typing = document.getElementById("typingIndicator");
  if (typing) typing.remove();
}

/* ---------- Reply Delivery ---------- */

function deliverReply(replyText, callback) {
  if (!replyText) return;

  interactionLocked = true;

  showTypingIndicator();

  const delay = Math.min(
    3000,
    Math.max(700, replyText.length * 16)
  );

  setTimeout(() => {
    removeTypingIndicator();
    addVoiceMessage(replyText);
    interactionLocked = false;

    if (typeof callback === "function") {
      callback();
    }

  }, delay);
}


/* =========================
   INTELLIGENCE ROUTER
========================= */

function handleIntelligence(text, originalText) {

  // Prevent overlapping replies while typing
  if (interactionLocked) return true;

  const lower = text.toLowerCase().trim();

  /* 1ï¸âƒ£ GREETING */
  if (/^(hi|hello|hey)\b/.test(lower)) {

  const words = originalText.trim().split(" ");
  const lastWord = words[words.length - 1];

  const cleaned = lastWord.replace(/[^a-zA-Z]/g, "");
const reply = cleaned.length > 1
  ? `Hello, ${cleaned}.`
  : "Hello.";

  deliverReply(reply);
  return true;
}
   
  /* 2ï¸âƒ£ VOICE IDENTITY */
  if (/(what is your name|who are you|your name)/.test(lower)) {
    const reply = activeVoice === "saira"
      ? "Iâ€™m Saira."
      : "Aayan.";

    deliverReply(reply);
    return true;
  }

  /* 3ï¸âƒ£ DIRECT NAME CALL */
  if (/^(saira|aayan)$/i.test(lower)) {

    if (lower === activeVoice) {
      deliverReply("Iâ€™m here.");
    } else {
      deliverReply(
        activeVoice === "saira"
          ? "He isnâ€™t here."
          : "She isnâ€™t here."
      );
    }

    return true;
  }

  /* 4ï¸âƒ£ BUY */
  if (/(buy|purchase|order|get|price|cost)/.test(lower)) {
    const reply = activeVoice === "saira"
      ? "You can find our story in the format that feels closest to you â€” digital, print, or audio."
      : "Itâ€™s available in digital, print, and audio. The form doesnâ€™t change what it carries.";

    deliverReply(reply);
    return true;
  }

  /* 5ï¸âƒ£ SEQUEL */
  if (/(part 2|sequel|next book|continue|future|more)/.test(lower)) {
    const reply = activeVoice === "saira"
      ? "Stories donâ€™t end. They change shape."
      : "What mattered didnâ€™t disappear.";

    deliverReply(reply);
    return true;
  }

  /* 6ï¸âƒ£ TECHNICAL */
  if (/(not working|frozen|stuck|not loading|can't click|cannot click)/.test(lower)) {
    const reply = activeVoice === "saira"
      ? "If something feels out of place, refresh and begin again."
      : "If it falters, refresh and return.";

    deliverReply(reply);
    return true;
  }

  /* 7ï¸âƒ£ EMOTIONAL */
  if (/(sad|hurt|pain|broken|cry|regret|angry|unfair|lost|heartbroken|disappointed|didn't like|bad ending|hate you)/.test(lower)) {

    let reply;

    if (activeVoice === "saira") {
      reply = emotionalToggle
        ? "Not everything needs to be resolved to be real."
        : "Some feelings donâ€™t ask for answers. They just stay.";
    } else {
      reply = emotionalToggle
        ? "Some things are understood without being solved."
        : "Not everything that hurts needs explaining.";
    }

    emotionalToggle = !emotionalToggle;
    deliverReply(reply);
    return true;
  }

  /* 8ï¸âƒ£ ABUSE (voice targeted only) */
  if (/(stupid|idiot|dumb|shut up|useless|worthless|trash|fuck you|screw you)/.test(lower)
      && /(you|saira|aayan)/.test(lower)) {

    const reply = activeVoice === "saira"
      ? "I wonâ€™t stay where respect isnâ€™t present."
      : "If this turns careless, Iâ€™ll remain silent.";

    deliverReply(reply);
    return true;
  }

  /* 9ï¸âƒ£ FOREIGN / RANDOM */
  if (!/[a-z]/i.test(originalText)) {
    const reply = activeVoice === "saira"
      ? "I may not understand that â€” but Iâ€™m still here."
      : "Some words donâ€™t reach me. Try again.";

    deliverReply(reply);
    return true;
  }

  return false;
}


/* ---------- Typed Input Handler ---------- */

function sendTypedMessage() {

  const input = document.getElementById("userInput");
  if (!input) return;

  const originalText = input.value.trim();
  if (!originalText) return;

  if (!activeVoice) {
    addSystemMessage("Please choose Saira or Aayan first.");
    return;
  }

  // Show user message ONCE
  addUserMessage(originalText);
  input.value = "";

  const text = originalText.toLowerCase();

  // ðŸ”¥ INTELLIGENCE ROUTER FIRST
  if (handleIntelligence(text, originalText)) {
    return;
  }

  // ðŸ” EXISTING MIRROR LOGIC

  let reply;

  if (text.includes("meet") || text.includes("first time")) {
    reply = activeVoice === "saira"
      ? "We didnâ€™t meet gently. It began with headlights and argument."
      : "It started with brakes and irritation. Not romance.";
  }

  else if (text.includes("love") || text.includes("feel")) {
    reply = activeVoice === "saira"
      ? "Love arrived quietly. It didnâ€™t ask permission."
      : "Love requires surrender. That wasnâ€™t easy for me.";
  }

  else if (text.includes("end") || text.includes("together")) {
    reply = activeVoice === "saira"
      ? "Not all endings are conclusions."
      : "What mattered didnâ€™t disappear.";
  }

  else if (text.includes("author") || text.includes("mohan")) {
    reply = activeVoice === "saira"
      ? "He wrote this honestly. That was enough."
      : "He chose truth over comfort.";
  }

  else {
    reply = activeVoice === "saira"
      ? "I donâ€™t always have the right words â€” but Iâ€™m listening."
      : "Some questions donâ€™t need quick answers.";
  }

  deliverReply(reply);
}

/* =========================
   INIT
========================= */

function loadWelcome() {
  chatBody.innerHTML = "";

  // FULL RESET
  activeVoice = null;
foundationalAnswered = new Set();
characterAnswered = 0;
currentLayer = 0;
reflections = [];
reflectionStep = 0;
interactionLocked = false; // reset lock
   
  const welcomeMessages = [
    "Hello.",
    "This is a quiet space.",
    "You can listen to our story through Saira or Aayan.",
    "Our story is a contemporary romantic fiction.",
    "When youâ€™re ready, you can choose a voice."
  ];

  // Neutral opening messages (no voice colour)
  welcomeMessages.forEach(text => {
  addSystemMessage(text);
});

  clearDock();

  dock.innerHTML = `
    <button class="btn saira" onclick="selectVoice('saira')">Saira</button>
    <button class="btn aayan" onclick="selectVoice('aayan')">Aayan</button>
  `;

  autoScroll();
}

/* =========================
   VOICE SELECTION
========================= */
function selectVoice(v) {

  interactionLocked = false; // reset lock

  activeVoice = v;
  clearDock();

  document.getElementById("typingArea").style.display = "flex";

  const intro =
    v === "saira"
      ? "Hello, this is Saira. I donâ€™t believe stories are meant to be explained too quickly â€” but I can sit with you and share what ours carries."
      : "Hello. This is Aayan. I donâ€™t speak easily about what stayed behind, but I can tell you what it asked of us.";

  addVoiceMessage(intro);
  showFoundational();
}

/* =========================
   FOUNDATIONAL
========================= */
function showFoundational() {
  clearDock();

  const questions = [
    { text: "What kind of story is this?", key: "story" },
    { text: "What is the story about?", key: "about" },
    { text: "Who is this story for?", key: "for" },
    { text: "Where can I read it?", key: "where" },
    { text: "Who is the author?", key: "author" }
  ];

  questions.forEach(q => {
    const btn = document.createElement("button");
    btn.className = "btn " + activeVoice;
    btn.textContent = q.text;
    btn.onclick = () => answerFoundational(q, btn);
    dock.appendChild(btn);
  });
}

function answerFoundational(q, btn) {
  if (interactionLocked) {
    const msg = activeVoice === "saira"
      ? "Let me finish this gentlyâ€¦ ðŸŒ™"
      : "Give it a moment. Iâ€™m still here. ðŸŒ¿";
    addVoiceMessage(msg);
    return;
  }

  btn.remove();
  foundationalAnswered.add(q.key);

  addUserMessage(q.text);

  const replies = {
  saira: {
    story: "Our story is a contemporary romantic fiction â€” but it moves quietly. It lingers in moments that donâ€™t seem significant at first, and then refuses to leave you. Itâ€™s less about grand declarations, and more about what remains unsaid.",
    
    about: "Itâ€™s about me and Aayan â€” about the kind of love that feels certain, even when life around it isnâ€™t. Itâ€™s about distance that isnâ€™t always physical, and choices that seem small until they change everything. Some stories are built on moments. Ours was built on hesitation.",
    
    for: "This story finds people who have felt something deeply and didnâ€™t know what to do with it. The ones who replay conversations long after theyâ€™ve ended. If youâ€™ve ever stood between love and fear â€” you already understand us.",
    
    where: "You can find our story in whatever form feels closest to you â€” as a Kindle eBook, in paperback, hardcover, or even as an audiobook. Some prefer to hold it. Some prefer to listen. However you choose, the story remains the same.",
    
    author: "Mohan R. wrote this as his debut novel. He didnâ€™t try to make it loud â€” only honest. I think he trusted silence as much as dialogue, and allowed the pauses to speak."
  },
  aayan: {
    story: "Itâ€™s a contemporary romantic fiction, but it lives in the space between love and responsibility. Itâ€™s about choices that donâ€™t feel urgent â€” until they are. And about how easily silence can become distance.",
    
    about: "Itâ€™s about timing â€” but not in the simple way people think. The feeling was never uncertain. What faltered was courage, and the belief that love would wait. Itâ€™s about how easily something real can slip into memory if you hesitate too long.",
    
    for: "Itâ€™s for those who believe feelings can wait â€” until they realise they canâ€™t. For people who have chosen responsibility over vulnerability, and wondered about the cost later. If youâ€™ve ever hesitated when it mattered most, this story will feel familiar.",
    
    where: "Itâ€™s available in digital, print, and audio formats. The format doesnâ€™t change what it carries â€” only how you meet it. Some stories are read. Some are heard. Ours survives both.",
    
    author: "Mohan R. wrote this story. Not to explain everything â€” but to sit with what lingers after love shifts. Some things are written for applause. This wasnâ€™t one of them."
  }
};

  const reply = replies[activeVoice][q.key];

  deliverReply(reply, function () {

    if (foundationalAnswered.size === 5) {
      unlockNextLayer();
    }

  });
}

/* =========================
   15 CHARACTER QUESTIONS
========================= */

const characterLayers = [
  // Layer 1 (5)
  [
  {
    q: "Where did you first meet?",
    a: {
      saira: "We didnâ€™t meet gently. I stepped into traffic for a photograph, and he nearly ran me over. There were headlights, brakes, rain on the road â€” and his voice, sharp and unamused. I remember the irritation first. The way he looked at me like I was a problem. But beneath itâ€¦ something sparked that neither of us understood.",
      aayan: "She walked into the road without looking. I slammed the brakes harder than Iâ€™ve ever had to. She should have been shaken â€” but she argued instead. Bold. Annoying. Completely unafraid of me. I told myself it was just frustration. It wasnâ€™t."
    }
  },
  {
    q: "What did you first notice?",
    a: {
      saira: "I noticed how controlled he was. Even angry, he didnâ€™t raise his voice â€” he just sharpened it. He looked at me like I was reckless, inconvenient. But there was something else in his eyes too â€” something calculating, almost curious. And that unsettled me more than the anger did.",
      aayan: "I noticed that she wasnâ€™t intimidated. Most people step back when challenged. She stepped closer. Even with a twisted ankle, she refused to yield. There was defiance in her â€” not loud, not dramatic â€” just steady. And I wasnâ€™t used to that."
    }
  },
  {
   q: "When did you start feeling it was more than temporary?",
    a: {
      saira: "It wasnâ€™t in Mumbai. That was just fire. It was in Venice. We were walking without speaking, the canals quiet around us, and for the first time I wasnâ€™t arguing with him. I was justâ€¦ at ease. That frightened me more than the chaos ever had.",
      aayan: "I donâ€™t believe in 'the one.' I believe in discipline, in clarity. But there was a moment when I stopped calculating and just watched her. She was laughing â€” unguarded, unaware that I was noticing the way she softened when she forgot to defend herself. That was when I realised she was no longer temporary."
    }
  },
  {
    q: "Who admitted their feelings first?",
    a: {
      saira: "I felt it first, but he was the one who said it. Though he had been carrying it just as long. I think he needed certainty before he allowed himself to be vulnerable.",
      aayan: "I did. But I think she knew before I did. I tend to weigh words before I let them go. Once I say something, I donâ€™t take it back."
    }
  },
  {
    q: "Which was the first city you were together in?",
    a: {
      saira: "As a couple, it wasnâ€™t Mumbai. It was our trip through Manali, Spiti, and Shimla. Five days that were meant to be brief â€” but stretched longer than we expected. Somewhere between the cold air and the quiet roads, the tension eased. That was the first time it felt like we were choosing each other.",
      aayan: "The first time we were truly together was during that trip through Manali, Spiti, and Shimla. It wasnâ€™t planned as something significant. But distance from the city changed the way we moved around each other. We stayed two extra days. I donâ€™t extend time for things that donâ€™t matter."
    }
  }
],

  // Layer 2 (5)
[
  {
    q: "Did you ever question your choice?",
    a: {
      saira: "Yes. Loving someone deeply doesnâ€™t silence doubt â€” it makes it more complicated. I questioned myself more than I questioned him, and that uncertainty lingered longer than I expected.",
      aayan: "I questioned the timing more than the feeling. The feeling was never uncertain â€” but I wasnâ€™t sure I was ready for its consequences."
    }
  },
  {
    q: "Were you ever afraid of loving each other?",
    a: {
      saira: "I was afraid of losing him, not loving him. Losing something that felt certain frightened me more than the feeling itself, because certainty had always felt fragile in my life.",
      aayan: "Yes. Love asks you to give up control. And I had built my life around control â€” structure, decisions, outcomes I could predict."
    }
  },
  {
    q: "What was your happiest moment together?",
    a: {
      saira: "It wasnâ€™t dramatic. It was the night before we left Goa. Nothing extraordinary happened â€” except that we were both at peace, and that felt rare in a life that rarely slowed down.",
      aayan: "Silence. Sitting beside her at Triveni Ghat, without needing to explain anything. That kind of understanding doesnâ€™t come easily, especially to someone like me."
    }
  },
  {
    q: "What moment stayed with you the longest?",
    a: {
      saira: "The moments when fear tried to take the place of love â€” and I let it. I replayed those moments more than the happy ones.",
      aayan: "The look she gave me when she understood what I couldnâ€™t say. It stayed longer than the words would have, because silence sometimes reveals more than speech."
    }
  },
  {
    q: "Which chapter feels closest to your heart?",
    a: {
      saira: "The one where everything felt possible â€” before doubt began to speak louder and before I allowed fear to interrupt something beautiful.",
      aayan: "The one where everything felt uncertain â€” because thatâ€™s when I realised what was at stake, even if I didnâ€™t admit it aloud."
    }
  }
],

 // Layer 3 (5)
[
  {
    q: "Did you finally meet again?",
    a: {
      saira: "Not in the way people imagine. But I stopped running â€” from him, and from myself. That mattered more than proximity ever did.",
      aayan: "No. And yes. We didnâ€™t stand face to face again. But after her, I stopped running â€” from responsibility, from legacy, from the dreams I once resisted. Some absences donâ€™t fade. They clarify."
    }
  },
  {
    q: "Is there more to your story?",
    a: {
      saira: "There is more. I finally chose courage over fear. And when fear stops deciding your life, the future rearranges itself.",
      aayan: "There is more. Iâ€™ve been building something meant to endure â€” not just for this season, but beyond it. Some foundations are laid in silence before they rise into something undeniable."
    }
  },
  {
    q: "Will there be a part two?",
    a: {
      saira: "Destiny doesnâ€™t disappear because we hesitate. If there is another chapter, it wonâ€™t be accidental. It will be earned.",
      aayan: "Some stories arenâ€™t finished â€” they pause. When timing aligns with strength, what was unfinished has a way of returning."
    }
  },
  {
    q: "If readers could learn one thing from you?",
    a: {
      saira: "Donâ€™t let fear disguise itself as logic. Courage may feel dangerous â€” but regret lasts longer.",
      aayan: "Build something worthy of return. Whether itâ€™s love, purpose, or legacy â€” make it strong enough to survive distance."
    }
  },
  {
    q: "Do you still think about each other?",
    a: {
      saira: "Yes. Not as a wound â€” but as a turning point. Some people enter your life to wake you up.",
      aayan: "Yes. Not with longing. With awareness. Some connections are not meant to fade â€” they are meant to mature."
    }
  }
]
];

function unlockNextLayer() {
  if (currentLayer >= characterLayers.length) return;

  clearDock();

  addSystemMessage("Thereâ€™s more, if youâ€™d like to continue.");

  setTimeout(() => {
    dock.innerHTML = `
      <button class="btn ${activeVoice}" onclick="showNextLayer()">Yes</button>
      <button class="btn" onclick="declineLayer()">No</button>
    `;
    autoScroll();
  }, 600);
}

function showNextLayer() {
  clearDock();

  characterLayers[currentLayer].forEach(item => {
    const btn = document.createElement("button");
    btn.className = "btn " + activeVoice;
    btn.textContent = item.q;
    btn.onclick = () => answerCharacter(item, btn);
    dock.appendChild(btn);
  });

  currentLayer++;
}

function answerCharacter(item, btn) {

  if (interactionLocked) {
    const msg = activeVoice === "saira"
      ? "Let me finish this gentlyâ€¦ ðŸŒ™"
      : "Give it a moment. Iâ€™m still here. ðŸŒ¿";
    addVoiceMessage(msg);
    return;
  }

  btn.remove();

  addUserMessage(item.q);

  const reply = item.a[activeVoice];

  deliverReply(reply, function () {
    characterAnswered++;

    if (characterAnswered % 5 === 0 && characterAnswered < 15) {
      unlockNextLayer();
    }

    if (characterAnswered === 15) {
      showAuthorInvitation();
    }
  });
}

/* =========================
   AUTHOR INVITATION
========================= */

function showAuthorInvitation() {
  clearDock();

  addSystemMessage("Youâ€™ve stayed with us until the end.");

setTimeout(() => {
  addSystemMessage("If youâ€™d like to write to the author, youâ€™re welcome to. He occasionally shares digital copies with readers who reach out thoughtfully.");
}, 500);

setTimeout(() => {
  addSystemMessage("wheretheskyremembersus@gmail.com");
}, 900);

setTimeout(() => {
  addSystemMessage("Before you leave, may I ask you three quiet reflections?");
}, 1300);

  setTimeout(() => {
  dock.innerHTML = `
    <button class="btn ${activeVoice}" onclick="startReflection()">Yes</button>
    <button class="btn" onclick="declineReflection()">No</button>
  `;
}, 1500);
} 
   function declineLayer() {
  clearDock();

  addSystemMessage(
    activeVoice === "saira"
      ? "Thank you for sitting with us."
      : "Thank you for staying."
  );

  dock.innerHTML = `
    <button class="btn saira" onclick="selectVoice('saira')">Saira</button>
    <button class="btn aayan" onclick="selectVoice('aayan')">Aayan</button>
    <button class="btn" onclick="returnToWebsite()">Return to the main site</button>
  `;

  autoScroll();
}

/* =========================
   REFLECTION
========================= */

function declineReflection() {
  clearDock();

  addSystemMessage(
  activeVoice === "saira"
    ? "Thank you for sitting with us."
    : "Thank you for staying."
);

  dock.innerHTML = `
    <button class="btn" onclick="returnToWebsite()">Return to the main site</button>
  `;
}

function startReflection() {
  reflections = [];
  reflectionStep = 0;
  nextReflection();
}

function nextReflection() {
  const sets = {
    saira: [
      ["How closely did this story stay with you?", ["ðŸŒ«ï¸","ðŸŒ±","ðŸ’›","ðŸŒ™","âœ¨"]],
      ["How clearly did the emotions feel?", ["ðŸŒ«ï¸","ðŸŒ±","ðŸ’›","ðŸŒ™","âœ¨"]],
      ["How drawn do you feel to continue?", ["ðŸš¶","ðŸ‘€","ðŸ’«","â¤ï¸","ðŸ“–"]]
    ],
    aayan: [
      ["How clearly did the emotional world reveal itself to you?", ["ðŸŒ‘","ðŸŒ˜","ðŸŒ—","ðŸŒ•","â˜€ï¸"]],
      ["How steady did the story feel?", ["ðŸŒ‘","ðŸŒ˜","ðŸŒ—","ðŸŒ•","â˜€ï¸"]],
      ["How drawn do you feel to continue reading?", ["ðŸš¶","ðŸ‘€","ðŸ’«","â¤ï¸","ðŸ“–"]]
    ]
  };

  if (reflectionStep === 3) {
    submitReflection();
    return;
  }

  clearDock();

  const [question, emojis] = sets[activeVoice][reflectionStep];

  addSystemMessage(question);

  emojis.forEach(e => {
    const btn = document.createElement("button");
    btn.className = "btn " + activeVoice;
    btn.textContent = e;
    btn.onclick = () => {
      reflections.push(e);
      reflectionStep++;
      nextReflection();
    };
    dock.appendChild(btn);
  });
}

/* =========================
   SUBMIT
========================= */

function submitReflection() {
  document.getElementById("formVoice").value = activeVoice;
  document.getElementById("r1").value = reflections[0];
  document.getElementById("r2").value = reflections[1];
  document.getElementById("r3").value = reflections[2];
  document.getElementById("formTime").value = new Date().toISOString();
  document.getElementById("reflectionForm").submit();

  dock.innerHTML = "";

  chatBody.insertAdjacentHTML(
  "beforeend",
  `<div class="message ${activeVoice === "saira" ? "saira-msg" : "aayan-msg"}">
     <div class="bubble">
       ${activeVoice === "saira"
         ? "Thank you for sitting with us. It means more than you know."
         : "Thank you for staying. Not everyone chooses to listen this closely."}
       <br><br>
       <button class="btn" onclick="returnToWebsite()">Return to the main site</button>
     </div>
   </div>`
);

  autoScroll();
}

/* =========================
   START
========================= */

loadWelcome();
   
</script>
